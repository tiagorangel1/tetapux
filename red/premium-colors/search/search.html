<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HetaSearch</title>
	<style>
		:root, body.light {
			--primary: #0d47a1;
			--text: #212121;
			--bg: white;
			--shadow: 0 0 4px rgba(0,0,0,0.1);
			--border: #e8eaed;
		}

		body.dark, body.dark * {
			--primary: #0d47a1;
			--text: white;
			--bg: #1a1a1a;
			--shadow: 0 0 8px rgba(0,0,0,0.4);
			--border: #353535;
		}

		body {
			font-family: 'Arial', sans-serif;
			margin: 0;
			background: var(--bg);
			color: var(--text);
			transition: background 0.3s, color 0.3s;
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}

		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
			flex: 1;
		}

		.header {
			margin-bottom: 30px;
			text-align: center;
		}

		.search-bar {
			position: relative;
			max-width: 700px;
			margin: 0 auto 20px;
			background: var(--bg);
			border: 1px solid var(--border);
			border-radius: 24px;
			padding: 8px 16px;
			display: flex;
			align-items: center;
			overflow-x: auto;
			gap: 10px;
			transition: box-shadow 0.2s;
		}

		.search-bar:focus-within {
			box-shadow: var(--shadow), 0 4px 6px rgba(0,0,0,0.2);
		}

		#search-input {
			flex: 1;
			min-width: 50px;
			max-width: 1000px;
			font-size: 16px;
			background: transparent;
			border: none;
			color: inherit;
			padding: 8px;
			outline: none;
			white-space: nowrap;
			text-overflow: ellipsis;
			overflow: visible;
			user-select: text;
			cursor: text;
			transition: width 0.2s;
			height: 32px;
			margin: 0;
		}

		#search-input::placeholder {
			color: var(--secondary-text, #888);
			opacity: 0.7;
		}

		.search-button {
			padding: 8px 16px;
			background: var(--primary);
			color: white;
			border: none;
			cursor: pointer;
			border-radius: 12px;
			transition: background 0.2s;
		}

		.search-button:hover {
			background: #1e88e5;
		}

		.results {
			max-width: 800px;
			margin: 20px auto;
			background: var(--bg);
			border-radius: 12px;
			padding: 20px;
			box-shadow: var(--shadow);
			transform: translateY(2px);
			transition: transform 0.3s;
		}

		.results:hover {
			transform: translateY(0);
		}

		.result {
			padding: 15px;
			border-bottom: 1px solid var(--border);
			transition: background-color 0.3s;
		}

		.result:hover {
			background: rgba(13, 71, 161, 0.05);
		}

		.result a {
			color: var(--primary);
			font-size: 18px;
			text-decoration: none;
			display: block;
			margin-bottom: 4px;
			transition: color 0.2s;
		}

		.result a:hover {
			color: #1e88e5;
			text-decoration: underline;
		}

		.result p {
			color: var(--text);
			font-size: 14px;
			margin: 4px 0;
			line-height: 1.6;
			opacity: 0.9;
		}

		.url {
			font-size: 12px;
			color: #808080;
			margin-top: 4px;
			word-break: break-all;
		}

		.pagination {
			display: flex;
			justify-content: center;
			gap: 12px;
			margin-top: 20px;
		}

		.page-button {
			padding: 6px 12px;
			border: 1px solid var(--border);
			border-radius: 4px;
			cursor: pointer;
			color: inherit;
			transition: background-color 0.2s, color 0.2s;
		}

		.page-button.active,
		.page-button:hover {
			background: var(--primary);
			color: white;
			border-color: var(--primary);
		}

		#dark-mode-toggle {
			position: fixed;
			top: 15px;
			right: 15px;
			padding: 6px 12px;
			background: var(--primary);
			color: white;
			border: none;
			border-radius: 20px;
			cursor: pointer;
			transition: background 0.2s;
			opacity: 0.9;
			font-weight: 500;
		}

		#dark-mode-toggle:hover {
			background: #1e88e5;
			opacity: 1;
		}

		@media (max-width: 600px) {
			.search-bar { max-width: 95%; padding: 4px 12px; }
			.search-button { padding: 4px 10px; }
			.results { padding: 12px; }
			.page-button { padding: 4px 8px; }
		}
	</style>
</head>
<body class="dark">
	<div class="container">
		<div class="header">
			<h1>HetaSearch</h1>
		</div>
		<div class="search-bar">
			<div contenteditable="true" id="search-input" placeholder="Search..."></div>
			<button class="search-button">Search</button>
		</div>
		<div class="results" id="results"></div>
		<div class="pagination" id="pagination"></div>
	</div>
	<button id="dark-mode-toggle">Toggle Theme</button>
	<script>
		const pages = [
			{ title: "Happy Phone", content: "You should make your phone happy now.", url: "/pages/happyphone.html" }
		];

		const searchInput = document.getElementById('search-input');
		const searchButton = document.querySelector('.search-button');
		const resultsDiv = document.getElementById('results');
		const paginationDiv = document.getElementById('pagination');
		const darkModeToggle = document.getElementById('dark-mode-toggle');

		let currentPage = 1;
		const resultsPerPage = 15;

		// Placeholder handling for contenteditable
		const initialPlaceholder = 'Search...';
		function updatePlaceholder(shouldShow) {
			if (shouldShow) {
				searchInput.textContent = initialPlaceholder;
				searchInput.style.color = 'var(--secondary-text)';
			} else {
				searchInput.textContent = '';
				searchInput.style.color = 'inherit';
			}
		}
		updatePlaceholder(true);
		searchInput.addEventListener('focus', () => {
			if (searchInput.textContent === initialPlaceholder) updatePlaceholder(false);
		});
		searchInput.addEventListener('blur', () => {
			if (searchInput.textContent.trim() === '') updatePlaceholder(true);
		});

		// Auto-resize search input
		const dummyDiv = document.createElement('div');
		dummyDiv.style.visibility = 'hidden';
		dummyDiv.style.position = 'absolute';
		dummyDiv.style.fontFamily = 'Arial, sans-serif';
		dummyDiv.style.fontSize = '16px';
		dummyDiv.style.whiteSpace = 'nowrap';
		document.body.appendChild(dummyDiv);

		function resizeSearchInput() {
			const text = searchInput.textContent.replace(/\s/g, ' ');
			dummyDiv.textContent = text + ' ';
			const width = dummyDiv.offsetWidth + 32;
			searchInput.style.width = `${Math.min(width, 700)}px`;
		}

		searchInput.addEventListener('input', resizeSearchInput);
		searchInput.addEventListener('focus', resizeSearchInput);

		function init() {
			const urlParams = new URLSearchParams(window.location.search);
			const pageParam = urlParams.get('page');
			const queryParam = urlParams.get('q');
			if (pageParam) currentPage = parseInt(pageParam);
			if (queryParam) {
				currentPage = 1;
				searchInput.textContent = decodeURIComponent(queryParam);
				updatePlaceholder(false);
				resizeSearchInput();
			}
			performSearch(searchInput.textContent.trim());
		}

		function performSearch(query) {
			if (!query.trim()) {
				resultsDiv.innerHTML = '';
				paginationDiv.innerHTML = '';
				return;
			}

			const filtered = pages.filter(page => {
				return page.title.toLowerCase().includes(query.toLowerCase()) ||
					page.content.toLowerCase().includes(query.toLowerCase());
			});

			const sorted = filtered.sort((a, b) => {
				const aScore = (a.title.toLowerCase().indexOf(query.toLowerCase()) === 0 ? 3 : 0) +
					(a.title.toLowerCase().includes(query.toLowerCase()) ? 2 : 0) +
					(a.content.toLowerCase().includes(query.toLowerCase()) ? 1 : 0);
				const bScore = (b.title.toLowerCase().indexOf(query.toLowerCase()) === 0 ? 3 : 0) +
					(b.title.toLowerCase().includes(query.toLowerCase()) ? 2 : 0) +
					(b.content.toLowerCase().includes(query.toLowerCase()) ? 1 : 0);
				return bScore - aScore;
			});

			displayPageResults(sorted);
			updatePagination(sorted.length);
		}

		function displayPageResults(results) {
			const totalPages = Math.ceil(results.length / resultsPerPage);
			if (currentPage > totalPages) currentPage = totalPages;

			const start = (currentPage - 1) * resultsPerPage;
			const end = start + resultsPerPage;
			const currentResults = results.slice(start, end);

			resultsDiv.innerHTML = currentResults.map(page => `
				<div class="result">
					<a href="${page.url}" target="_blank">${page.title}</a>
					<div class="url">${page.url}</div>
					<p>${page.content}</p>
				</div>
			`).join('');
		}

		function updatePagination(totalResults) {
			const totalPages = Math.ceil(totalResults / resultsPerPage);
			paginationDiv.innerHTML = '';

			if (totalPages === 0) return;

			// Previous button
			let prevButton = document.createElement('div');
			prevButton.className = 'page-button' + (currentPage === 1 ? ' disabled' : '');
			prevButton.textContent = 'Previous';
			prevButton.onclick = () => {
				if (currentPage > 1) currentPage--;
				performSearch(searchInput.textContent.trim());
			};
			paginationDiv.appendChild(prevButton);

			// Page numbers
			for (let i = 1; i <= totalPages; i++) {
				const btn = document.createElement('div');
				btn.className = 'page-button' + (i === currentPage ? ' active' : '');
				btn.textContent = i;
				btn.onclick = () => {
					currentPage = i;
					performSearch(searchInput.textContent.trim());
				};
				paginationDiv.appendChild(btn);
			}

			// Next button
			let nextButton = document.createElement('div');
			nextButton.className = 'page-button' + (currentPage === totalPages ? ' disabled' : '');
			nextButton.textContent = 'Next';
			nextButton.onclick = () => {
				if (currentPage < totalPages) currentPage++;
				performSearch(searchInput.textContent.trim());
			};
			paginationDiv.appendChild(nextButton);
		}

		searchButton.addEventListener('click', () => {
			const query = searchInput.textContent.trim();
			currentPage = 1;
			history.pushState(null, '', `?q=${encodeURIComponent(query)}&page=${currentPage}`);
			performSearch(query);
		});

		// Handle enter key
		searchInput.addEventListener('keydown', (e) => {
			if (e.key === 'Enter') {
				e.preventDefault();
				searchButton.click();
			}
		});

		// Theme toggle
		darkModeToggle.addEventListener('click', () => {
			document.body.classList.toggle('dark');
			document.body.classList.toggle('light');
			localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
			performSearch(searchInput.textContent.trim());
		});

		function updateURL(query, page) {
			const params = new URLSearchParams();
			if (query) params.set('q', query);
			if (page) params.set('page', page);
			history.pushState(null, '', `?${params.toString()}`);
		}

		window.addEventListener('popstate', (e) => {
			const urlParams = new URLSearchParams(window.location.search);
			const pageParam = urlParams.get('page');
			const queryParam = urlParams.get('q');
			currentPage = pageParam ? parseInt(pageParam) : 1;
			searchInput.textContent = queryParam || '';
			if (queryParam) {
				updatePlaceholder(false);
				resizeSearchInput();
			} else {
				updatePlaceholder(true);
			}
			performSearch(queryParam || '');
		});

		const savedTheme = localStorage.getItem('theme');
		if (savedTheme) {
			document.body.classList.add(savedTheme);
			document.body.classList.toggle('dark', savedTheme === 'dark');
			document.body.classList.toggle('light', savedTheme === 'light');
		}

		init();
	</script>
</body>
</html>